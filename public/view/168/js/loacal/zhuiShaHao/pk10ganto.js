$(function(){function t(t){var e=t.getFullYear(),a=t.getMonth()+1;a=a<10?"0"+a:a;var o=t.getDate();return o=o<10?"0"+o:o,e+"-"+a+"-"+o}var e=location.href.split("?")[1].split("=")[1];if($("#tost_img").addClass("tost_"+e),"10058"==e){var a=$("title").text();$("title").text(a.replace(/北京PK10/g,"SG飞艇")),$("#lotName_IMG").attr("src","../../img/small_logo/sgAirship.png")}else{var o=LOTTERY_LOTCODE[e].lotCodeType;$("#lotName_IMG").attr("src","../../img/small_logo/"+o+".png")}$("#headdivbox").load("../public/head.html",function(){config.ifdebug});var l=!0,i=!0;$("#fooderbox").load("../public/fooder.html",function(){pupajax(),config.ifdebug}),$("#user_adv").load("../public/user_adv.html",function(){config.ifdebug}),$("#gotop").click(function(){return $("body,html").animate({scrollTop:0},500),$(this).hide(),!1}),$(document).scroll(function(){$(this).scrollTop()>10?$("#gotop").show():$("#gotop").hide(),$(this).scrollTop()>130?$(".menubannbox").css({position:"fixed",top:"0"}):$(".menubannbox").css({position:"relative"})}),$(".backTop").on("click",function(){$("body,html").animate({scrollTop:0},500)});var n=config.formatDate();$(".date").val(n),$("#datebox").calendar({trigger:".date",zIndex:999,format:"yyyy-mm-dd",onSelected:function(t,e,a){var o=(e=config.formatDate(e)).split("-");checkseletime(o),s=1*o[1]<=9?o[0]+"-"+o[1]+"-"+o[2]:e,objli(s)},onClose:function(t,e,a){config.ifdebug}});var s=$(".date").val(),r=s.split("-");1*r[1]<=9&&(s=r[0]+"-"+r[1]+"-"+r[2]),objli=function(t){$.ajax({type:"get",url:publicUrl+"/LotteryPlan/getBetInfoList.do",async:!0,dataType:"json",data:{date:t,lotCode:e},success:function(t){resultHtml(t)},error:function(t){}})},objli(s),resultHtml=function(e){"string"==typeof e&&(e=JSON.parse(e)),arr=e.result.data;var a,o,n,s,r,u,c,d,p,m=!0,f="";$.each(arr,function(e,h){if(a=h.ballNum,o=1==h.bigOrSmall?"大":"小",n=h.ballBsBet,s=0==h.ballBsf?"?":h.ballBsf,r=1==h.singleOrDouble?"单":"双",c=0==h.ballSdf?"?":h.ballSdf,u=h.ballSdBet,d=""===h.subtotal?"?":h.subtotal+"分",p=""===h.sumtotal?"?":h.sumtotal+"分",0==e&&""!==h.sumtotal)$(".pushball").text(a),$(".sum_result").text(h.sumtotal),0==(b=50-1*h.sumtotal<=0?"目标已完成":50-1*h.sumtotal).toString().indexOf("目标已完成")?($(".jsVal").text(b),t(new Date)==$(".date").val()&&l&&(l=!1,i=!1)):$(".jsVal").text("距离目标："+b),m=!1;else if(1==e&&m){$(".pushball").text(a),$(".sum_result").text(h.sumtotal);var b=50-1*h.sumtotal<=0?"目标已完成":50-1*h.sumtotal;$(".jsVal").text("距离目标："+b)}"?"!=s&&(s="-1"==s.toString().indexOf("-")?"赢"+s+"分":s.toString().replace("-","输")+"分"),"?"!=c&&(c="-1"==c.toString().indexOf("-")?"赢"+c+"分":c.toString().replace("-","输")+"分");var v=[],g="等待开奖";""!=h.preDrawCode&&(g="<ul> <li class='numsm"+(v=h.preDrawCode.split(","))[0]+" "+(1==1*a?"push":"")+"'></li><li class='numsm"+v[1]+" "+(2==1*a?"push":"")+"'></li><li class='numsm"+v[2]+" "+(3==1*a?"push":"")+"'></li><li class='numsm"+v[3]+" "+(4==1*a?"push":"")+"'></li><li class='numsm"+v[4]+" "+(5==1*a?"push":"")+"'></li><li class='numsm"+v[5]+" "+(6==1*a?"push":"")+"'></li><li class='numsm"+v[6]+" "+(7==1*a?"push":"")+"'></li><li class='numsm"+v[7]+" "+(8==1*a?"push":"")+"'></li><li class='numsm"+v[8]+" "+(9==1*a?"push":"")+"'></li><li class='numsm"+v[9]+" "+(10==1*a?"push":"")+"'></li></ul>"),f+="<tr><td>"+h.preDrawTime+"</td><td>"+h.preDrawIssue+"期</td><td>"+g+"</td><td>"+a+"球</td><td class='oth_cla'><span>"+o+"</span><span>"+s+"</span></td><td>"+n+"分</td><td class='oth_cla'><span>"+r+"</span><span>"+c+"</span></td><td>"+u+"分</td><td class='98k'>"+d+"</td><td>"+p+"</td></tr>"}),$(".th_til").siblings().remove(),$(".th_til").after(f),$("#result_table .oth_cla>span:contains('赢')").css("color","#FD3A3A"),$("#result_table .oth_cla>span:contains('?')").css({color:"#FD3A3A","margin-left":"25px"}),$("#result_table td.98k:contains('?')").css("color","#FD3A3A")};var u=function(t,a,o,l){var i=t.replace("-","/"),a=a.replace("-","/");i=i.replace("-","/"),a=a.replace("-","/");var l=void 0!==l?l:0,n=$(o).find(".hour"),s=$(o).find(".minute"),r=$(o).find(".second"),u=$(o).find(".opentyle"),c=$(o).find(".cuttime"),d=(new Date(i)-new Date(a))/1e3,m=!0,f=new Date;$(".countDowm .countDownWrap").show(),$(".countDowm .stopbox").hide();var h=setInterval(function(){var t=Math.abs(new Date-f)/1e3;if(f=new Date,(t=t.toString().split("."))[0]>1&&(d-=t[0]),m?(m=!1,tools.playSound("begin")):tools.playSound(d),d>1&&0===l){d-=1;var a=Math.floor(d/3600),i=Math.floor(d/60%60),b=Math.floor(d%60);$(n).text(a<10?"0"+a:a),$(s).text(i<10?"0"+i:i),$(r).text(b<10?"0"+b:b),a<=0?($(o).find(".hourtxt").hide(),$(n).hide()):($(o).find(".hourtxt").show(),$(n).show()),$(u).hide(),$(c).css({display:"inline-block"})}else 1===l?($(u).hide(),$(c).hide(),$(".countDowm .countDownWrap").hide(),$(".countDowm .stopbox").show(),clearInterval(h)):($(u).show(),$(c).hide(),clearInterval(h),setTimeout(function(){p("",e,"#pk10kai")},1e3))},1e3)},c=function(t,e){var a,e=e,o=(t=t).length,l=0,n=$(e).find(".numberbox");pk10animate&&e==pkid||($(n).empty(),a=setInterval(function(){pkid=e,pk10animate=!0;var i="";if(l<o){l==o-1&&(i="li_after");var s="<li class='numsm"+t[l]+" "+i+"'><i style='font-size:10px; display:none'>"+t[l]+"</i></li>";$(n).append(s),l+=1}else clearInterval(a),pk10animate=!1},60),$(e).find(".opentyle").hide(),$(e).find(".cuttime").show(),$("#waringbox").hide("200"),i&&setTimeout(function(){objli(s)},3e3))},d=function(t){var e=600;$(t+" .numberbox").find("li");$(t).find(".opentyle").show(),$(t).find(".cuttime").hide();var a=setInterval(function(){var a=[1,2,3,4,5,6,7,8,9,10],o=[];e--;for(var l=0;l<10;l++){var i=Math.floor(Math.random()*a.length);o[l]=a[i],a.splice(i,1)}for(var n="",s=0;s<10;s++){var r=o[s]<10?"numsm0"+o[s]:"numsm"+o[s];n+=9==s?"<li style='margin-right: 0px;' class='"+r+"'></li>":"<li class='"+r+"'></li>"}$(t).find(".numberbox").empty(),$(t).find(".numberbox").append(n),100==e&&$("#waringbox").show(300)},100);animateID[t]=a},p=function t(a,o,l){var a=void 0==a?"":a,i=!1;$.ajax({url:publicUrl+"pks/getLotteryPksInfo.do?issue="+a,type:"GET",data:{lotCode:o},timeout:6e4,beforeSend:function(){void 0==animateID[l]&&d(l)},success:function(a){try{m(a,e,l),clearInterval(animateID[l]),delete animateID[l]}catch(a){setTimeout(function(){t("",e,"#pk10kai")},1e3)}},error:function(a){setTimeout(function(){t("",e,"#pk10kai")},1e3),i=!0},complete:function(t,e){(i=!1)||"timeout"==e&&setTimeout(function(){ajaxRequst(a,l)},"1000")}})},m=function(t,e,a){var o=tools.parseObj(t);if("100002"==o.result.businessCode)throw new Error("error");o=o.result.data,$(".change_lotName").text(o.lotName);tools.operatorTime(""==o.drawTime?"0":o.drawTime,o.serverTime);$(a).find(".opentyle").hide(),$(a).find(".cuttime").css({display:"inline-block"});o.totalCount,$(a).find(".nextIssue").text();$(a).find(".nextIssue").text(o.drawIssue),$(a).find(".preDrawIssue").text(o.preDrawIssue);var l=o.preDrawCode.split(",");u(o.drawTime,o.serverTime,a,o.lotteryStatus),c(l,a)};p("",e,"#pk10kai"),$(".close_target").click(function(){$(this).parent().parent().hide()})});