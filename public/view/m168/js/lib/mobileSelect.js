var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t){return e.getElementsByClassName(t)}function t(e){this.mobileSelect,this.wheelsData=e.wheels,this.jsonType=!1,this.cascadeJsonData=[],this.displayJson=[],this.curValue=null,this.curIndexArr=[],this.cascade=!1,this.startY,this.moveEndY,this.moveY,this.oldMoveY,this.offset=0,this.offsetSum=0,this.oversizeBorder,this.curDistance=[],this.clickStatus=!1,this.isPC=!0,this.init(e)}t.prototype={constructor:t,init:function(t){var i=this;if(i.keyMap=t.keyMap?t.keyMap:{id:"id",value:"value",childs:"childs"},i.checkDataType(),i.extendsOpts(t._mySelectOpts),i.renderWheels(i.wheelsData,t.cancelBtnText,t.ensureBtnText,t.trigger),i.trigger=document.querySelector(t.trigger),!i.trigger)return!1;if(!i.mobileSelect)return!1;if(i.wheel=e(i.mobileSelect,"wheel"),i.slider=e(i.mobileSelect,"selectContainer"),i.wheels=i.mobileSelect.querySelector(".wheels"),i.liHeight=i.mobileSelect.querySelector("li").offsetHeight,i.ensureBtn=i.mobileSelect.querySelector(".ensure"),i.cancelBtn=i.mobileSelect.querySelector(".cancel"),i.grayLayer=i.mobileSelect.querySelector(".grayLayer"),i.popUp=i.mobileSelect.querySelector(".content_date"),i.callback=t.callback||function(){},i.transitionEnd=t.transitionEnd||function(){},i.onShow=t.onShow||function(){},i.onHide=t.onHide||function(){},i.initPosition=t.position||[],i.titleText=t.title||"",i.connector=t.connector||" ",i.triggerDisplayData=void 0===t.triggerDisplayData||t.triggerDisplayData,i.trigger.style.cursor="pointer",i.setStyle(t),i.setTitle(i.titleText),i.checkIsPC(),i.checkCascade(),i.addListenerAll(),i._mySelectOpts._type&&i.selectAction(),i.cascade&&i.initCascade(),i.initPosition.length<i.slider.length)for(var n=i.slider.length-i.initPosition.length,s=0;s<n;s++)i.initPosition.push(0);i.setCurDistance(i.initPosition),i.initSelectedState(),i.cancelBtn.addEventListener("click",function(){i.hide()}),i.ensureBtn.addEventListener("click",function(){i.hide();var e=[],t=[];if(i._mySelectOpts._type)$("#"+i.TriggerIdentify+" li.check_tj").each(function(i,n){e.push(n.dataset.value),t.push(n.innerHTML)}),i.curIndexArr=t,i.curValue=e,i._mySelectOpts._selectedArr=e,e.length>0?$(i.trigger).addClass("checkspan"):$(i.trigger).removeClass("checkspan");else{i.liHeight||(i.liHeight=i.mobileSelect.querySelector("li").offsetHeight);for(var n="",s=0;s<i.wheel.length;s++)s==i.wheel.length-1?n+=i.getInnerHtml(s):n+=i.getInnerHtml(s)+i.connector;i.triggerDisplayData&&(i.trigger.innerHTML=n),i.curIndexArr=i.getIndexArr(),i.curValue=i.getCurValue()}i.callback(i.curIndexArr,i.curValue,e)}),i.trigger.addEventListener("click",function(){i.show()}),i.grayLayer.addEventListener("click",function(){i.hide()}),i.grayLayer.addEventListener("touchmove",function(e){return e.preventDefault(),!1},!0),i.popUp.addEventListener("touchmove",function(e){return e.preventDefault(),!1}),i.popUp.addEventListener("click",function(){event.stopPropagation()}),i.fixRowStyle()},extendsOpts:function(e){var t=this,i={_type:void 0,_fastCtr:!1,_mulitSelect:!0,_selectedArr:[]};if(e&&"[object Object]"===Object.prototype.toString.call(e))for(var n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);t._mySelectOpts=i},setTitle:function(e){var t=this;t.titleText=e,t.mobileSelect.querySelector(".title").innerHTML=t.titleText},setStyle:function(e){var t=this;e.ensureBtnColor&&(t.ensureBtn.style.color=e.ensureBtnColor),e.cancelBtnColor&&(t.cancelBtn.style.color=e.cancelBtnColor),e.titleColor&&(t.title=t.mobileSelect.querySelector(".title"),t.title.style.color=e.titleColor),e.textColor&&(t.panel=t.mobileSelect.querySelector(".panel"),t.panel.style.color=e.textColor),e.titleBgColor&&(t.btnBar=t.mobileSelect.querySelector(".btnBar"),t.btnBar.style.backgroundColor=e.titleBgColor),e.bgColor&&(t.panel=t.mobileSelect.querySelector(".panel"),t.shadowMask=t.mobileSelect.querySelector(".shadowMask"),t.panel.style.backgroundColor=e.bgColor,t.shadowMask.style.background="linear-gradient(to bottom, "+e.bgColor+", rgba(255, 255, 255, 0), "+e.bgColor+")"),isNaN(e.maskOpacity)||(t.grayMask=t.mobileSelect.querySelector(".grayLayer"),t.grayMask.style.background="rgba(0, 0, 0, "+e.maskOpacity+")")},checkIsPC:function(){var e=this,t=navigator.userAgent.toLowerCase(),i="ipad"==t.match(/ipad/i),n="iphone os"==t.match(/iphone os/i),s="midp"==t.match(/midp/i),a="rv:1.2.3.4"==t.match(/rv:1.2.3.4/i),l="ucweb"==t.match(/ucweb/i),r="android"==t.match(/android/i),o="windows ce"==t.match(/windows ce/i),c="windows mobile"==t.match(/windows mobile/i);(i||n||s||a||l||r||o||c)&&(e.isPC=!1)},show:function(){this.mobileSelect.classList.add("mobileSelect-show"),window.app&&window.app.showH5Dialog&&window.app.showH5Dialog(!0),window.webkit&&window.webkit.messageHandlers.showH5Dialog&&window.webkit.messageHandlers.showH5Dialog.postMessage("yes"),"function"==typeof this.onShow&&this.onShow(this)},hide:function(){this.mobileSelect.classList.remove("mobileSelect-show"),window.app&&window.app.showH5Dialog&&window.app.showH5Dialog(!1),window.webkit&&window.webkit.messageHandlers.showH5Dialog&&window.webkit.messageHandlers.showH5Dialog.postMessage("no"),"function"==typeof this.onHide&&this.onHide(this)},initSelectedState:function(){var e=this._mySelectOpts._selectedArr;$("#"+this.TriggerIdentify+" li.myType").removeClass("check_tj");for(var t=0;t<e.length;t++)$("li[data-value='"+e[t]+"']").addClass("check_tj");e.length>0?$(this.trigger).addClass("checkspan"):$(this.trigger).removeClass("checkspan")},selectAction:function(){var e="#"+this.TriggerIdentify+" .myUl",t=this._mySelectOpts._mulitSelect;document.querySelector(e).addEventListener("click",function(t,i){var n=$(i.target);n.hasClass("fastCtr_chkAll")&&$(e+" .myType").addClass("check_tj"),n.hasClass("fastCtr_delAll")&&$(e+" .myType").removeClass("check_tj"),n.hasClass("fastCtr_null")||(t?n.toggleClass("check_tj"):n.addClass("check_tj").siblings().removeClass("check_tj"))}.bind(null,t))},renderWheels:function(e,t,i,n){var s=this;if(n="F_"+n.slice(1),s.TriggerIdentify=n,document.getElementById(n))return!1;var a=t||"取消",l=i||"确定";s.mobileSelect=document.createElement("div"),s.mobileSelect.className="mobileSelect";var r=void 0!==s._mySelectOpts._type&&""!==s._mySelectOpts._type,o="";r||(o='<div class="selectLine"></div><div class="shadowMask"></div>'),s.mobileSelect.innerHTML='<div class="grayLayer"></div><div class="content_date" id="'+n+'" ><div class="btnBar"><div class="fixWidth"><div class="cancel">'+a+'</div><div class="title"></div><div class="ensure">'+l+'</div></div></div><div class="panel"><div class="fixWidth"><div class="wheels"></div>'+o+"</div></div></div>",document.body.appendChild(s.mobileSelect);for(var c="",d=0;d<e.length;d++){var h=e[d].data.length;if(r){c+='<div class="wheel"><ul class="selectContainer myUl" '+(h>3?"":" style='justify-content:space-between;' ")+" >",s._mySelectOpts._fastCtr?c+='<li class="fastCtr_null" >&nbsp;</li><li class="fastCtr_null fastCtr_chkAll" >全选</li><li class="fastCtr_null fastCtr_delAll" >清空</li><li class="fastCtr_null" >&nbsp;</li>':c+='<li class="fastCtr_null" >&nbsp;</li><li class="fastCtr_null" >&nbsp;</li><li class="fastCtr_null" >&nbsp;</li><li class="fastCtr_null" >&nbsp;</li>';for(u=0;u<h;u++)c+='<li class="myType" data-value="'+e[d].data[u].value+'" >'+e[d].data[u].name+"</li>"}else if(c+='<div class="wheel"><ul class="selectContainer">',s.jsonType)for(u=0;u<e[d].data.length;u++)c+='<li data-id="'+e[d].data[u][s.keyMap.id]+'">'+e[d].data[u][s.keyMap.value]+"</li>";else for(var u=0;u<h;u++)c+="<li>"+e[d].data[u]+"</li>";c+="</ul></div>"}s.mobileSelect.querySelector(".wheels").innerHTML=c},addListenerAll:function(){for(var e=this,t=0;t<e.slider.length;t++)!function(t){e.addListenerWheel(e.wheel[t],t)}(t)},addListenerWheel:function(e,t){var i=this;i._mySelectOpts._type||(e.addEventListener("touchstart",function(){i.touch(event,this.firstChild,t)},!1),e.addEventListener("touchend",function(){i.touch(event,this.firstChild,t)},!1),e.addEventListener("touchmove",function(){i.touch(event,this.firstChild,t)},!1),i.isPC&&(e.addEventListener("mousedown",function(){i.dragClick(event,this.firstChild,t)},!1),e.addEventListener("mousemove",function(){i.dragClick(event,this.firstChild,t)},!1),e.addEventListener("mouseup",function(){i.dragClick(event,this.firstChild,t)},!0)))},checkDataType:function(){var e=this;"object"==_typeof(e.wheelsData[0].data[0])&&(e.jsonType=!0)},checkCascade:function(){var e=this;if(e.jsonType){for(var t=e.wheelsData[0].data,i=0;i<t.length;i++)if(e.keyMap.childs in t[i]&&t[i][e.keyMap.childs].length>0){e.cascade=!0,e.cascadeJsonData=e.wheelsData[0].data;break}}else e.cascade=!1},generateArrData:function(e){for(var t=[],i=this.keyMap.id,n=this.keyMap.value,s=0;s<e.length;s++){var a={};a[i]=e[s][this.keyMap.id],a[n]=e[s][this.keyMap.value],t.push(a)}return t},initCascade:function(){var e=this;e.displayJson.push(e.generateArrData(e.cascadeJsonData)),e.initPosition.length>0?(e.initDeepCount=0,e.initCheckArrDeep(e.cascadeJsonData[e.initPosition[0]])):e.checkArrDeep(e.cascadeJsonData[0]),e.reRenderWheels()},initCheckArrDeep:function(e){var t=this;if(e&&t.keyMap.childs in e&&e[t.keyMap.childs].length>0){t.displayJson.push(t.generateArrData(e[t.keyMap.childs])),t.initDeepCount++;var i=e[t.keyMap.childs][t.initPosition[t.initDeepCount]];i?t.initCheckArrDeep(i):t.checkArrDeep(e[t.keyMap.childs][0])}},checkArrDeep:function(e){var t=this;e&&t.keyMap.childs in e&&e[t.keyMap.childs].length>0&&(t.displayJson.push(t.generateArrData(e[t.keyMap.childs])),t.checkArrDeep(e[t.keyMap.childs][0]))},checkRange:function(e,t){for(var i=this,n=i.displayJson.length-1-e,s=0;s<n;s++)i.displayJson.pop();for(var a,s=0;s<=e;s++)a=0==s?i.cascadeJsonData[t[0]]:a[i.keyMap.childs][t[s]];i.checkArrDeep(a),i.reRenderWheels(),i.fixRowStyle(),i.setCurDistance(i.resetPosition(e,t))},resetPosition:function(e,t){var i,n=this,s=t;if(n.slider.length>t.length){i=n.slider.length-t.length;for(a=0;a<i;a++)s.push(0)}else if(n.slider.length<t.length){i=t.length-n.slider.length;for(a=0;a<i;a++)s.pop()}for(var a=e+1;a<s.length;a++)s[a]=0;return s},reRenderWheels:function(){var e=this;if(e.wheel.length>e.displayJson.length)for(var t=e.wheel.length-e.displayJson.length,i=0;i<t;i++)e.wheels.removeChild(e.wheel[e.wheel.length-1]);for(i=0;i<e.displayJson.length;i++)!function(t){var i="";if(e.wheel[t]){for(s=0;s<e.displayJson[t].length;s++)i+='<li data-id="'+e.displayJson[t][s][e.keyMap.id]+'">'+e.displayJson[t][s][e.keyMap.value]+"</li>";e.slider[t].innerHTML=i}else{var n=document.createElement("div");n.className="wheel",i='<ul class="selectContainer">';for(var s=0;s<e.displayJson[t].length;s++)i+='<li data-id="'+e.displayJson[t][s][e.keyMap.id]+'">'+e.displayJson[t][s][e.keyMap.value]+"</li>";i+="</ul>",n.innerHTML=i,e.addListenerWheel(n,t),e.wheels.appendChild(n)}}(i)},updateWheels:function(e){var t=this;if(t.cascade){if(t.cascadeJsonData=e,t.displayJson=[],t.initCascade(),t.initPosition.length<t.slider.length)for(var i=t.slider.length-t.initPosition.length,n=0;n<i;n++)t.initPosition.push(0);t.setCurDistance(t.initPosition),t.fixRowStyle()}},updateWheel:function(e,t){var i=this,n="";if(i.cascade)return!1;if(i.jsonType){for(s=0;s<t.length;s++)n+='<li data-id="'+t[s][i.keyMap.id]+'">'+t[s][i.keyMap.value]+"</li>";i.wheelsData[e]={data:t}}else{for(var s=0;s<t.length;s++)n+="<li>"+t[s]+"</li>";i.wheelsData[e]=t}i.slider[e].innerHTML=n},fixRowStyle:function(){for(var e=this,t=(100/e.wheel.length).toFixed(2),i=0;i<e.wheel.length;i++)e.wheel[i].style.width=t+"%"},getIndex:function(e){return Math.round((2*this.liHeight-e)/this.liHeight)},getIndexArr:function(){for(var e=this,t=[],i=0;i<e.curDistance.length;i++)t.push(e.getIndex(e.curDistance[i]));return t},getCurValue:function(){var e=this,t=[],i=e.getIndexArr();if(e.cascade)for(n=0;n<e.wheel.length;n++)t.push(e.displayJson[n][i[n]]);else if(e.jsonType)for(n=0;n<e.curDistance.length;n++)t.push(e.wheelsData[n].data[e.getIndex(e.curDistance[n])]);else for(var n=0;n<e.curDistance.length;n++)t.push(e.getInnerHtml(n));return t},getValue:function(){return this.curValue},calcDistance:function(e){return 2*this.liHeight-e*this.liHeight},setCurDistance:function(e){for(var t=this,i=[],n=0;n<t.slider.length;n++)i.push(t.calcDistance(e[n])),t.movePosition(t.slider[n],i[n]);t.curDistance=i},fixPosition:function(e){return-(this.getIndex(e)-2)*this.liHeight},movePosition:function(e,t){e.style.webkitTransform="translate3d(0,"+t+"px, 0)",e.style.transform="translate3d(0,"+t+"px, 0)"},locatePosition:function(e,t){var i=this;this.curDistance[e]=this.calcDistance(t),this.movePosition(this.slider[e],this.curDistance[e]),i.cascade&&i.checkRange(e,i.getIndexArr())},updateCurDistance:function(e,t){e.style.transform?this.curDistance[t]=parseInt(e.style.transform.split(",")[1]):this.curDistance[t]=parseInt(e.style.webkitTransform.split(",")[1])},getDistance:function(e){return e.style.transform?parseInt(e.style.transform.split(",")[1]):parseInt(e.style.webkitTransform.split(",")[1])},getInnerHtml:function(e){var t=this,i=t.getIndex(t.curDistance[e]);return t.slider[e].getElementsByTagName("li")[i].innerHTML},touch:function(e,t,i){var n=this;switch((e=e||window.event).type){case"touchstart":n.startY=e.touches[0].clientY,n.startY=parseInt(n.startY),n.oldMoveY=n.startY;break;case"touchend":if(n.moveEndY=parseInt(e.changedTouches[0].clientY),n.offsetSum=n.moveEndY-n.startY,n.oversizeBorder=-(t.getElementsByTagName("li").length-3)*n.liHeight,0==n.offsetSum){var s=parseInt((document.documentElement.clientHeight-n.moveEndY)/40);if(2!=s){var a=s-2,l=n.curDistance[i]+a*n.liHeight;l<=2*n.liHeight&&l>=n.oversizeBorder&&(n.curDistance[i]=l,n.movePosition(t,n.curDistance[i]),n.transitionEnd(n.getIndexArr(),n.getCurValue()))}}else n.updateCurDistance(t,i),n.curDistance[i]=n.fixPosition(n.curDistance[i]),n.movePosition(t,n.curDistance[i]),n.curDistance[i]+n.offsetSum>2*n.liHeight?(n.curDistance[i]=2*n.liHeight,setTimeout(function(){n.movePosition(t,n.curDistance[i])},100)):n.curDistance[i]+n.offsetSum<n.oversizeBorder&&(n.curDistance[i]=n.oversizeBorder,setTimeout(function(){n.movePosition(t,n.curDistance[i])},100)),n.transitionEnd(n.getIndexArr(),n.getCurValue());n.cascade&&n.checkRange(i,n.getIndexArr());break;case"touchmove":e.preventDefault(),n.moveY=e.touches[0].clientY,n.offset=n.moveY-n.oldMoveY,n.updateCurDistance(t,i),n.curDistance[i]=n.curDistance[i]+n.offset,n.movePosition(t,n.curDistance[i]),n.oldMoveY=n.moveY}},dragClick:function(e,t,i){var n=this;switch((e=e||window.event).type){case"mousedown":n.startY=e.clientY,n.oldMoveY=n.startY,n.clickStatus=!0;break;case"mouseup":if(n.moveEndY=e.clientY,n.offsetSum=n.moveEndY-n.startY,n.oversizeBorder=-(t.getElementsByTagName("li").length-3)*n.liHeight,0==n.offsetSum){var s=parseInt((document.documentElement.clientHeight-n.moveEndY)/40);if(2!=s){var a=s-2,l=n.curDistance[i]+a*n.liHeight;l<=2*n.liHeight&&l>=n.oversizeBorder&&(n.curDistance[i]=l,n.movePosition(t,n.curDistance[i]),n.transitionEnd(n.getIndexArr(),n.getCurValue()))}}else n.updateCurDistance(t,i),n.curDistance[i]=n.fixPosition(n.curDistance[i]),n.movePosition(t,n.curDistance[i]),n.curDistance[i]+n.offsetSum>2*n.liHeight?(n.curDistance[i]=2*n.liHeight,setTimeout(function(){n.movePosition(t,n.curDistance[i])},100)):n.curDistance[i]+n.offsetSum<n.oversizeBorder&&(n.curDistance[i]=n.oversizeBorder,setTimeout(function(){n.movePosition(t,n.curDistance[i])},100)),n.transitionEnd(n.getIndexArr(),n.getCurValue());n.clickStatus=!1,n.cascade&&n.checkRange(i,n.getIndexArr());break;case"mousemove":e.preventDefault(),n.clickStatus&&(n.moveY=e.clientY,n.offset=n.moveY-n.oldMoveY,n.updateCurDistance(t,i),n.curDistance[i]=n.curDistance[i]+n.offset,n.movePosition(t,n.curDistance[i]),n.oldMoveY=n.moveY)}}},"object"==("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=t:"function"==typeof define&&define.amd?define([],function(){return t}):(window.MobileSelect=t,!window.closeMobileSelect&&(window.closeMobileSelect=function(){document.querySelector(".mobileSelect-show").classList.remove("mobileSelect-show")}))}();