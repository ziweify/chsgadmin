var games;var fastBetSelected=[];var isGuest;$(document).ready(function(){resetBets();checkIsGuest();fastBetSelected=[]});$(function(){$(".quick_sec_table tr td").click(function(){resetBets();fastBets=[];if(!PeriodPanel.period||(PeriodPanel.period.closeTime<$.now())){parent.showMsg("后台未开盘，请等待开盘再试。");return}$(this).toggleClass("on");let rowId=$(this).attr("id");let keys=rowId.split("_");isFastBet=true;var b=0;var a=$("label.checkdefault input").prop("checked");if(a==true){b=sessionStorage.getItem("QuickAmount")}else{b=0}$.ajax({url:"/member/odds",type:"GET",data:{lottery:lottery,games:games},success:function(f){try{if(f==""){dialog.error("消息","获取赔率资料有误")}else{var d=new Map();for(var c in f){d.set(c,f[c])}if(keys.length==2){processShortKeys(keys,d,b)}else{processLongKeys(keys,d,b)}if(fastBets.length>0){parent.showBets({lottery:lottery,drawNumber:PeriodPanel.period.drawNumber,bets:fastBets,fastBets:true},null,function(e){if(e=="done"){resetBets()}})}}}catch(g){dialog.error(g)}}})});$(".quick_sec_table #fastBetSetting").click(function(){let fastBetOptions=options;chooseFastBetsOption(fastBetSelected,fastBetOptions,function(b){var a={template:template,lottery:lottery,selectedOptions:b};if(isGuest==false){saveFastBetOptions(a)}else{getGuestFastBetOptions(a)}})})});function showSelectedList(a){let fastBetOptions=options;var b=[];for(let s=0;s<a.length;s++){b.push(a[s].betSelectId);$("#"+a[s].betSelectId).removeAttr("style")}fastBetOptions.forEach(function c(e,d){if(!b.includes(d)){$("#"+d).attr("style","display:none")}})}function processShortKeys(c,b,a){switch(c[0]){case"DX":case"DS":case"WDX":case"HDS":allBallsGames(c);createAllBallsBets(c,b,a);break;case"LH":halfBallsGames(c);createHalfBallsBets(c,b,a);break;case"FB":case"RB":case"MFB":case"MRB":followReverseBetGames(c,b,a);break;case"GDX":case"GDS":top2RacingGames(c);createTop2RacingGamesBets(c,b,a);break;case"PFB":case"PRB":followReverseBetGamesSSC(c,b,a);break}}function processLongKeys(c,b,a){switch(c[0]){case"DX":case"DS":splitBallsGames(c);createSplitBallsGamesBets(c,b,a);break;case"BALL":allBallsSumGames(c);createAllBallsSumBets(c,b,a);break;case"TM":singleRankGame(c);createSingleRankBets(c,b,a);break;case"CL":changLongBetGames(c,b,a);break;case"FB":case"RB":case"MFB":case"MRB":splitFollowReverseBetGames(c,b,a);break}}function allBallsGames(b){var a=BALL_NUMBERS;for(let i=1;i<=a;i++){$("#t_"+b[0]+i+"_"+b[1]).addClass("selected");$("#o_"+b[0]+i+"_"+b[1]).addClass("selected");$("#a_"+b[0]+i+"_"+b[1]).addClass("selected")}}function halfBallsGames(b){var a=BALL_NUMBERS/2;for(let i=1;i<=a;i++){$("#t_"+b[0]+i+"_"+b[1]).addClass("selected");$("#o_"+b[0]+i+"_"+b[1]).addClass("selected");$("#a_"+b[0]+i+"_"+b[1]).addClass("selected")}}function allBallsSumGames(b){const a=[];a.push(b[1]);a.push(b[2]);allBallsGames(a);$("#t_Z"+a[0]+"_"+a[1]).addClass("selected");$("#o_Z"+a[0]+"_"+a[1]).addClass("selected");$("#a_Z"+a[0]+"_"+a[1]).addClass("selected")}function singleRankGame(d){const b=[];var a=RANK_BALL_NUMBERS;const c=[];if(template!="SSC"){switch(d[2]){case"D":for(let i=1;i<=a;i++){if(i%2==1){c.push(i)}}break;case"S":for(let i=1;i<=a;i++){if(i%2==0){c.push(i)}}break;case"B":for(let i=a;i>a/2;i--){c.push(i)}break;case"X":for(let i=1;i<=a/2;i++){c.push(i)}break}}else{switch(d[2]){case"D":for(let i=0;i<=a;i++){if(i%2==1){c.push(i)}}break;case"S":for(let i=0;i<=a;i++){if(i%2==0){c.push(i)}}break;case"B":for(let i=a;i>a/2;i--){c.push(i)}break;case"X":for(let i=0;i<=a/2;i++){c.push(i)}break}}b.push(d[1]);b.push(d[2]);if(template!="KLSF"){for(let i=0;i<c.length;i++){$("#t_"+b[0]+"_"+c[i]).addClass("selected");$("#o_"+b[0]+"_"+c[i]).addClass("selected");$("#a_"+b[0]+"_"+c[i]).addClass("selected")}}else{for(let i=0;i<c.length;i++){if(c[i]<10){$("#t_"+b[0]+"_0"+c[i]).addClass("selected");$("#o_"+b[0]+"_0"+c[i]).addClass("selected");$("#a_"+b[0]+"_0"+c[i]).addClass("selected")}else{$("#t_"+b[0]+"_"+c[i]).addClass("selected");$("#o_"+b[0]+"_"+c[i]).addClass("selected");$("#a_"+b[0]+"_"+c[i]).addClass("selected")}}}}function createAllBallsBets(j,d,a){var e=BALL_NUMBERS;var c=j[1];for(let i=1;i<=e;i++){var f=ballsNameMap.get(i);var g=betNameMap.get(j[0]+"_"+j[1]);var h=j[0]+i;let oddsKey=h+"_"+j[1];var k=d.get(oddsKey);var b={title:f,text:g,game:h,contents:c,amount:a===0?null:a,odds:k};fastBets.push(b)}}function createHalfBallsBets(j,d,a){var e=BALL_NUMBERS/2;var c=j[1];for(let i=1;i<=e;i++){var f=ballsNameMap.get(i);var g=betNameMap.get(j[0]+"_"+j[1]);var h=j[0]+i;let oddsKey=h+"_"+j[1];var k=d.get(oddsKey);var b={title:f,text:g,game:h,contents:c,amount:a===0?null:a,odds:k};fastBets.push(b)}}function createAllBallsSumBets(h,f,e){const g=[];g.push(h[1]);g.push(h[2]);createAllBallsBets(g,f,e);var j=betNameMap.get("Z"+g[0]+"_"+g[1]);var d="Z"+g[0];let oddsKey=d+"_"+g[1];var c=f.get(oddsKey);var a={title:"",text:j,game:d,contents:g[1],amount:e===0?null:e,odds:c};fastBets.push(a)}function createSingleRankBets(m,d,a){const f=[];f.push(m[1]);f.push(m[2]);var e=RANK_BALL_NUMBERS;const h=[];if(template!="SSC"){switch(m[2]){case"D":for(let i=1;i<=e;i++){if(i%2==1){h.push(i)}}break;case"S":for(let i=1;i<=e;i++){if(i%2==0){h.push(i)}}break;case"B":for(let i=e;i>e/2;i--){h.push(i)}break;case"X":for(let i=1;i<=e/2;i++){h.push(i)}break}}else{switch(m[2]){case"D":for(let i=0;i<=e;i++){if(i%2==1){h.push(i)}}break;case"S":for(let i=0;i<=e;i++){if(i%2==0){h.push(i)}}break;case"B":for(let i=e;i>e/2;i--){h.push(i)}break;case"X":for(let i=0;i<=e/2;i++){h.push(i)}break}}var g=ballsNameMap.get(f[0]);var l=f[0];var k;var c;switch(template){case"KLSF":for(let i=0;i<h.length;i++){if(h[i]<10){k="0"+h[i];c=l+"_0"+h[i]}else{k=h[i];c=l+"_"+h[i]}var j=parseInt(h[i]);var n=d.get(c);var b={title:g,text:k,game:l,contents:k,amount:a===0?null:a,odds:n,sortNum:j};fastBets.push(b)}break;case"SSC":case"PK10":for(let i=0;i<h.length;i++){k=h[i];c=l+"_"+h[i];var j=parseInt(h[i]);var n=d.get(c);var b={title:g,text:k,game:l,contents:k,amount:a===0?null:a,odds:n,sortNum:j};fastBets.push(b)}break}fastBets.sort(sortBets)}function followReverseBetGames(c,b,a){$.ajax({url:"/member/fastBet/followReverse",type:"GET",data:{lottery:lottery,fastBetId:c[0]+"_"+c[1],drawNumber:PeriodPanel.period.drawNumber},success:function(d){try{if(d==null||d==""){dialog.error("消息","所选项目在这个期数没有结果，请选择其他快选项目");resetBets()}else{createFollowReverseFastBets(d,b,a);if(fastBets==null||fastBets.length==0){dialog.error("消息","所选项目在这个期数没有结果，请选择其他快选项目");resetBets()}else{parent.showBets({lottery:lottery,drawNumber:PeriodPanel.period.drawNumber,bets:fastBets},null,function(e){if(e=="done"){resetBets()}})}}}catch(f){dialog.error(f)}},error:function(d){dialog.error("消息","所选项目在这个期数没有结果，请选择其他快选项目");resetBets()}})}function createFollowReverseFastBets(h,g,a){const d=new RegExp(/^[a-zA-Z]+/);const c=new RegExp(/[0-9]+/);for(var f in h){var n=parseInt(f.match(c)[0]);var j=ballsNameMap.get(n);var m=betNameMap.get(f.match(d)[0]+"_"+h[f]);var l=f;let oddsKey=f+"_"+h[f];var o=g.get(oddsKey);var e=h[f];var b={title:j,text:m,game:l,contents:e,amount:a===0?null:a,odds:o,sortNum:n};fastBets.push(b)}fastBets.sort(sortBets)}function changLongBetGames(c,b,a){$.ajax({url:"/member/fastBet/changLongGames",type:"GET",data:{lottery:lottery,fastBetId:c[0]+"_"+c[1]+"_"+c[2],drawNumber:PeriodPanel.period.drawNumber},success:function(d){try{if(d==null||d==""){dialog.error("消息","所选项目在这个期数没有结果，请选择其他快选项目");resetBets()}else{createCLGamesBets(d,b,a);if(fastBets.length==0){dialog.error("消息","所选项目在这个期数没有结果，请选择其他快选项目");resetBets()}else{parent.showBets({lottery:lottery,drawNumber:PeriodPanel.period.drawNumber,bets:fastBets},null,function(e){if(e=="done"){resetBets()}})}}}catch(f){dialog.error(f)}},error:function(d){dialog.error("消息","所选项目在这个期数没有结果，请选择其他快选项目");resetBets()}})}function createCLGamesBets(h,g,a){const d=new RegExp(/^[a-zA-Z]+/);const c=new RegExp(/[0-9]+/);for(var f in h){var j="";if(f.match(c)!=null){j=ballsNameMap.get(parseInt(f.match(c)[0]))}var m=betNameMap.get(f.match(d)[0]+"_"+h[f]);var l=f;let oddsKey=f+"_"+h[f];var n=g.get(oddsKey);var e=h[f];var b={title:j,text:m,game:l,contents:e,amount:a===0?null:a,odds:n};fastBets.push(b)}}function top2RacingGames(b){var a=2;$("#t_"+b[0]+"_"+b[1]).addClass("selected");$("#o_"+b[0]+"_"+b[1]).addClass("selected");$("#a_"+b[0]+"_"+b[1]).addClass("selected");for(let i=1;i<=a;i++){$("#t_"+b[0].substring(1,3)+i+"_"+b[1]).addClass("selected");$("#o_"+b[0].substring(1,3)+i+"_"+b[1]).addClass("selected");$("#a_"+b[0].substring(1,3)+i+"_"+b[1]).addClass("selected")}}function createTop2RacingGamesBets(k,d,a){var e=2;for(let i=1;i<=e;i++){var f=ballsNameMap.get(i);var h=betNameMap.get(k[0].substring(1,3)+"_"+k[1]);var j=k[0].substring(1,3)+i;let oddsKey=j+"_"+k[1];var l=d.get(oddsKey);var c=k[1];var b={title:f,text:h,game:j,contents:c,amount:a===0?null:a,odds:l};fastBets.push(b)}var g={title:"",text:betNameMap.get(k[0]+"_"+k[1]),game:k[0],contents:k[1],amount:a===0?null:a,odds:d.get(k[0]+"_"+k[1])};fastBets.push(g)}function splitBallsGames(b){var a=BALL_NUMBERS;if(b[2]=="T"){for(let i=1;i<=a/2;i++){$("#t_"+b[0]+i+"_"+b[1]).addClass("selected");$("#o_"+b[0]+i+"_"+b[1]).addClass("selected");$("#a_"+b[0]+i+"_"+b[1]).addClass("selected")}}else{for(let i=(a/2)+1;i<=a;i++){$("#t_"+b[0]+i+"_"+b[1]).addClass("selected");$("#o_"+b[0]+i+"_"+b[1]).addClass("selected");$("#a_"+b[0]+i+"_"+b[1]).addClass("selected")}}}function createSplitBallsGamesBets(j,d,a){var e=BALL_NUMBERS;var c=j[1];if(j[2]=="T"){for(let i=1;i<=e/2;i++){var f=ballsNameMap.get(i);var g=betNameMap.get(j[0]+"_"+j[1]);var h=j[0]+i;let oddsKey=h+"_"+j[1];var k=d.get(oddsKey);var b={title:f,text:g,game:h,contents:c,amount:a===0?null:a,odds:k};fastBets.push(b)}}else{for(let i=(e/2)+1;i<=e;i++){var f=ballsNameMap.get(i);var g=betNameMap.get(j[0]+"_"+j[1]);var h=j[0]+i;let oddsKey=h+"_"+j[1];var k=d.get(oddsKey);var b={title:f,text:g,game:h,contents:c,amount:a===0?null:a,odds:k};fastBets.push(b)}}}function splitFollowReverseBetGames(c,b,a){$.ajax({url:"/member/fastBet/splitFollowReverse",type:"GET",data:{lottery:lottery,fastBetId:c[0]+"_"+c[1]+"_"+c[2],ballNumber:BALL_NUMBERS,drawNumber:PeriodPanel.period.drawNumber},success:function(d){try{if(d==null||d==""){dialog.error("消息","所选项目在这个期数没有结果，请选择其他快选项目");resetBets()}else{createFollowReverseFastBets(d,b,a);if(fastBets.length==0){dialog.error("消息","所选项目在这个期数没有结果，请选择其他快选项目");resetBets()}else{parent.showBets({lottery:lottery,drawNumber:PeriodPanel.period.drawNumber,bets:fastBets},null,function(e){if(e=="done"){resetBets()}})}}}catch(f){dialog.error(f)}},error:function(d){dialog.error("消息","所选项目在这个期数没有结果，请选择其他快选项目");resetBets()}})}function followReverseBetGamesSSC(c,b,a){$.ajax({url:"/member/fastBet/followReverseSSC",type:"GET",data:{lottery:lottery,fastBetId:c[0]+"_"+c[1],drawNumber:PeriodPanel.period.drawNumber},success:function(d){try{if(d==null||d==""){dialog.error("消息","所选项目在这个期数没有结果，请选择其他快选项目");resetBets()}else{createFollowReverseFastBetsSSC(d,b,a);if(fastBets.length==0){dialog.error("消息","所选项目在这个期数没有结果，请选择其他快选项目");resetBets()}else{parent.showBets({lottery:lottery,drawNumber:PeriodPanel.period.drawNumber,bets:fastBets},null,function(e){if(e=="done"){resetBets()}})}}}catch(f){dialog.error(f)}},error:function(d){dialog.error("消息","所选项目在这个期数没有结果，请选择其他快选项目");resetBets()}})}function createFollowReverseFastBetsSSC(h,g,a){const d=new RegExp(/^[a-zA-Z]+/);const c=new RegExp(/[0-9]+/);for(var f in h){var j;if(f.match(c)!=null){j=ballsNameMap.get(parseInt(f.match(c)[0]))}else{j=""}var m=betNameMap.get(f.match(d)[0]+"_"+h[f]);var l=f;let oddsKey=f+"_"+h[f];var n=g.get(oddsKey);var e=h[f];var b={title:j,text:m,game:l,contents:e,amount:a===0?null:a,odds:n};fastBets.push(b)}}function chooseFastBetsOption(f,d,j){var a=$("#fastBetChoose");a.attr("style","position:absolute;");a.attr("style","left:350px;");a.attr("style","width:400px;");a.attr("style","top:50px;");if(a.length==0){a=$('<div id="fastBetChoose"></div>').appendTo("body");a.append("<ul>");a.dialog({modal:true,title:"设置快选选项",autoOpen:false,width:800,buttons:{"确定":function(){var m=$(this);var l=[];var n=0;m.find("ul input:checked").each(function(){l.push($(this).val());n++});if(n>20){dialog.error("消息","所选的快选项目不可以超过20项")}else{if(n==0){dialog.error("消息","请设置至少一个快选项目")}else{m.dialog("close");var k=m.data("callback");if($.isFunction(k)){k(l.join(","))}}}},"取消":function(){$(this).dialog("close")},"重置":function(){f=[];chooseFastBetsOption(f,d,j)}}})}a.data("callback",j);var g=a.find("ul").empty();var h=[];for(var e=0;e<f.length;e++){var c=f[e];h.push(c.betSelectId);$('<li><input type="checkbox" checked="checked" value="'+c.betSelectId+'">'+c.name+"</li>").appendTo(g)}d.forEach(function b(l,k){if(!h.includes(k)){$('<li><input type="checkbox" value="'+k+'">'+l+"</li>").appendTo(g)}});a.dialog("open");document.querySelector('[aria-describedby="fastBetChoose"]').setAttribute("style","position: absolute;height: auto;width: 800px;top: 0px;left: 100px;display: block;")}function saveFastBetOptions(a){$.ajax({url:"/member/fastBet/saveFastBetOptions",type:"POST",contentType:"application/json",data:JSON.stringify(a),success:function(b){location.reload()},error:function(b){dialog.error("消息","保存失败")}})}function getGuestFastBetOptions(a){$.ajax({url:"/member/fastBet/getGuestFastBetOptions",type:"GET",contentType:"application/json",data:a,success:function(b){try{if(!b.success){dialog.error("消息","拿取会员的设置快选项目的资料失败，请联络技术人员")}else{fastBetSelected=[];var c=[];for(let i=0;i<b.data.length;i++){fastBetSelected.push(b.data[i]);c.push(fastBetSelected[i].betSelectId)}showSelectedList(fastBetSelected);sessionStorage.removeItem(lottery);sessionStorage.setItem(lottery,c.join(","))}}catch(d){dialog.error(d)}},error:function(b){dialog.error("消息","保存失败")}})}function sortBets(e,c){const f=e.sortNum;const d=c.sortNum;let comparison=0;if(f>d){comparison=1}else{if(f<d){comparison=-1}}return comparison}function checkIsGuest(){$.ajax({url:"/member/fastBet/user/isGuest",type:"GET",success:function(a){try{if(a.data==0){isGuest=true}else{isGuest=false}showUserFastBet()}catch(b){dialog.error(b)}}})}function showUserFastBet(){if(isGuest===false){$.ajax({url:"/member/fastBet/user/data",type:"GET",contentType:"application/json",data:{lottery:lottery},success:function(d){try{if(!d.success){dialog.error("消息","拿取会员的设置快选项目的资料失败，请联络技术人员")}else{for(let i=0;i<d.data.length;i++){fastBetSelected.push(d.data[i])}showSelectedList(fastBetSelected)}}catch(f){dialog.error(f)}}})}else{var c;var b=sessionStorage.getItem(lottery);if(b==null||b==""){sessionStorage.setItem(lottery,guestDefault);c=guestDefault.join(",")}else{c=b}var a={template:template,lottery:lottery,selectedOptions:c};getGuestFastBetOptions(a)}};