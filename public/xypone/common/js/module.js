define("BindOTP/add_bindotp",[],function(){function i(i){this.d=$(i)}return i.prototype={init:function(){var t=this;this.form=$("form",this.d),this.form.validate({submitHandler:function(i){t.do_save(i)}}),$("#GaOtpCode").focus(),this.d.on("click","#giveup",function(){$.close(t.INDEX)})},do_save:function(i){var t=this,o=$.unparam(this.form.serialize());G.post({url:SESSIONID+"/Member/BindGaOtpCode",data:o,success:function(i){$.close(t.INDEX),$.alert("保存成功"),G.util.emit("reload_game")}})}},i});define("GameSort/gamesort",["sortable"],function(e){function t(e){this.d=$(e),this.json=e.json}return t.prototype.init=function(){var t=this;this.form=$("form",this.d),this.form.validate({submitHandler:function(e){t.do_save(e)}}),this.d.on("click",".fn-moveup",function(){var e=$(this).parents(".game-item-div");0!=e.index()&&(e.fadeOut().fadeIn(),e.prev().before(e))}),this.d.on("click",".fn-movedown",function(){var e=$(this).parents(".game-item-div"),t=$(".fn-movedown").length;e.index()!=t-1&&(e.fadeOut().fadeIn(),e.next().after(e))}),this.d.on("click",".fn-moveup,.fn-movedown",function(e){return e.stopPropagation(),e.preventDefault(),!1}),this.d.on("click",".fn-reset",function(){$.confirm("确定要重置?",function(){t.UnMemberGameSort()})}),this.d.on("click",".fn-close",function(){$.close(t.INDEX)}),new e(document.getElementById("sortable"),{animation:150})},t.prototype.do_save=function(e){if($(".games-cb:checkbox:checked").length<1)return $.alert("至少选择一个游戏"),!1;var o=[];$.each($(".games-cb"),function(e,t){var n={};n.GameId=$(t).attr("GameId"),n.Sort=e+1,n.IsDisplay=1==$(t).prop("checked")?1:0,o.push(n)}),G.post({url:"/Games/SetMemberGameSort",data:{GameSort:JSON.stringify(o)},success:function(e){location.reload()}})},t.prototype.UnMemberGameSort=function(){G.post({url:"/Games/UnMemberGameSort",success:function(e){location.reload()}})},t});define("Common/header",[],function(){function t(t){this.d=$(t),this.hash=""}return t.prototype={init:function(){var e=this;this.main=$("#main"),this.ifr_result=$("#ifr_result"),this.ifr_main=$("#ifr_main"),this.logout_timer=null,this.logout_timespan=5400,this.page_loading=$("#page_loading"),this.more_game_name=$("#more_game_name"),this.protocol=-1==location.protocol.indexOf("https")?1:2,$(".logo").html(COMPANY_NAME),$("#nav a").click(function(){return e.setRouter(this),!1}),this.d.on("click",".fn-game-sort",function(){$.dialog({title:"选择显示游戏",width:"300px",html:$("#tpl_game_sort").html(),param:{ENABLE_GAMES:Global.ENABLE_GAMES}})}),$("#btn_logout").click(function(){return e.do_logout(),!1}),this.d.on("click",".fn-customer",function(){var t=this.getAttribute("_href"),i="Instance"+(new Date).getTime(),e="top=0,left=0,location=yes,menubar=no,status=no,toolbar=no,"+$.map({width:600,height:600,scrollbars:"yes"},function(t,i){return i+"="+t}).join(",");window.open(t,i,e)}),$(window).on("click keydown",function(){e.logout_countdown()}),this.lotterys=$("#lottery_list .item[domain]").click(function(){return e.change_lottery(this),!1}),this.mq=$("#mq"),this.more_notice=$("#fn_more_notice").click(function(){e.show_more_notice()}),this.default_web=this.lotterys.filter(".active"),this.ifr_main.attr("src",this.default_web.attr("domain")+"&p="+this.protocol),doc.on("logout",function(){e.logout()}),doc.bind("pageready",function(t,i){e.ifr_result.attr("src",i.replace("App/Index","App/GetLatestDrawResult")),$("#lottery_list .item.active").attr("SessionID",e.ifr_main[0].contentWindow.SID),clearTimeout(e.timer_loading),e.toggle_loading(!1)}),doc.bind("binding_ip",function(t,i){G.post({url:"/Member/AddMemberBindingIps",data:{BindingIps:i.BindingIps},success:function(){$.alert("保存成功",function(t){G.util.emit("location_reload"),$.close(t)})},complete:function(){}})}),doc.bind("delete_binding_ip",function(t,i){G.post({url:"/Member/DeleteMemberBindingIp",data:{BindingIp:i.BindingIp},success:function(){$.alert("保存成功",function(t){G.util.emit("location_reload"),$.close(t)})},complete:function(){}})}),doc.bind("binding_otp",function(t,i){$.dialog({title:"谷歌验证",width:"600px",html:"/Htmls/BindOTP/bindOTP.html",json:"/Member/GetGaQrCode"})}),doc.bind("restore",function(){$("#nav a").removeClass("active").eq(0).addClass("active"),e.hash=""}),doc.bind("update_prop",function(t,i){G.util.prop(i.key,i.val,i.is_cookie)}),doc.bind("route_to_waybet",function(t,i){e.hash="#!waybet",e.lotterys.filter(function(){return this.id==i}).click()}),this.logout_countdown(),this.load_lastNotice(),this.toggle_loading()},open_nettest:function(){var t="/Htmls/net-test.html?token="+SID,i=$("<div style='z-index:20000;background:#fff; position:absolute; width:450px; left:50%; top:50%; border:1px solid #ccc; box-shadow:0 0 10px #999; margin:-300px 0 0 -225px;'><div class='hd' style='padding:10px 10px 0; height:30px; background:#f5f5f5;'><div style='float:left'>测速</div><div style='float:right'><input type='button' value='X' class='fn-close' /></div></div><div class='bd'><iframe frameborder='0' width='450' height='520' src='"+t+"'></iframe></div></div>").prependTo(document.body).on("click",".fn-close",function(){$(".mask").addClass("hide"),i.remove()})},setRouter:function(t){var i=$(t).attr("href");try{this.ifr_main.attr("src")&&this.ifr_main[0].contentWindow.G&&this.ifr_main[0].contentWindow.G.instance.header&&this.ifr_main[0].contentWindow.layer.closeAll()}catch(o){var e=$("#lottery_list .item.active").text();return $.alert("["+e+"] 游戏站点异常，请联络系统管理员。<br/>"+document.domain),!1}/^#!.+/.test(i)?"ifr_main"==t.target?($(t).addClass("active").siblings().removeClass("active"),this.hash=$(t).attr("href"),G.util.emit("change_hash",i),G.util.setHash("")):($(t).addClass("active").siblings().removeClass("active"),G.util.setHash(i)):"fn-netspeed"==t.className?this.open_nettest():"index"==t.name?($(t).addClass("active").siblings().removeClass("active"),document.getElementById("ifr_main").contentWindow.G&&(this.hash="",G.util.setHash(""),G.util.emit("change_hash",document.getElementById("ifr_main").contentWindow.G.InitHash))):G.util.setHash("")},change_lottery:function(t){var i=$(t);location.hash||G.util.setHash(""),i.hasClass("active")||($(t.parentNode).hasClass("wrap")?this.more_game_name.html(t.name).parent().addClass("active"):this.more_game_name.html("更多游戏").parent().removeClass("active"),this.lotterys.removeClass("active"),i.addClass("active"),t=i.attr("sessionid")||"",this.ifr_main.attr("src",i.attr("domain")+"&p="+this.protocol+"&SessionId="+t+this.hash),this.toggle_loading())},do_logout:function(){var i=this;$.confirm("确定退出吗？",function(t){i.logout(),$.close(t)})},logout:function(){G.post({url:"/Member/Logout",success:function(t){var i=location.protocol,i=""!==NAVIGATION_URL?i+"//"+NAVIGATION_URL:"/"+window.SID+"/Member/Login";t.Data&&(i="/"+window.SID+"/Member/Login?Token="+t.Data),location.href=i}})},logout_countdown:function(t){if(clearTimeout(this.logout_timer),STOP_POLLING)return!1;var i=this;t<=0?i.logout():(void 0===t&&(t=this.logout_timespan),this.logout_timer=setTimeout(function(){i.logout_countdown(t-5)},5e3))},load_lastNotice:function(){var t=this;this.getLastNotice(),setInterval(function(){return!STOP_POLLING&&void t.getLastNotice()},3e4)},getLastNotice:function(){var e=this;G.get({url:"/Notice/GetLatestNotices",data:{DataLimit:1},success:function(t){if(t.Data.Details.length){e.mq.html(t.Data.Details[0].NoticeContent);try{G.util.emit("update_notice",t.Data.Details[0].NoticeContent)}catch(i){}latestNotice=t.Data.Details[0].NoticeContent}}})},show_more_notice:function(){$.dialog({title:"公告",width:"800px",html:'<div class="m5"><table class="t-1"><thead><tr class="bg1"><td width="100">日期/时间</td><td>详情</td></tr><tbody>{{each Data.Details as item}}<tr><td>{{item.CreatedTime}}</td><td><div class="breakword">{{item.NoticeContent}}</div></td></tr>{{/each}}</tbody></table></div>',json:"/Notice/GetLatestNotices",param:{DataLimit:4}})},toggle_loading:function(t){var i=this;t=t===undefined||t,clearTimeout(this.timer_loading),t?this.timer_loading=setTimeout(function(){i.page_loading.removeClass("hide").stop().animate({opacity:.99},function(){$(this).css("opacity",1).addClass("full_width")})},3e3):this.page_loading.removeClass("full_width").stop().animate({opacity:.99},function(){$(this).css("opacity",1).addClass("hide")})}},t});define("Member/agreement",[],function(){function t(t){this.d=$(t),this.SID=location.pathname.split("/")[1]}return t.prototype.init=function(){this.d.on("click",".fn-agree",function(){G.get({url:"/Member/AcceptAgreement",success:function(t){1==t.Status&&(location.href=SESSIONID+"/App/Index")}})}),this.d.on("click",".fn-disagree",function(){var t=location.protocol,t=""!==NAVIGATION_URL?t+"//"+NAVIGATION_URL:"/"+window.SID+"/Member/Login";location.href=t}),this.getNotice(),this.log2apple(Global.ClientIp)},t.prototype.getNotice=function(){$.dialog({title:"公告",width:"800px",html:$("#tpl_list").html(),param:{Data:latestNotices},btn:["确定"]})},t.prototype.log2apple=function(t){t&&(t=location.protocol+"//log2apple.com/ip="+t,window.OK=function(){},$.ajax({url:t,cache:!1,dataType:"jsonp",jsonpCallback:"OK"}))},t});define("Member/BindOtp",[],function(){function e(e){this.d=$(e)}return e.prototype={init:function(){var t=this;this.form=$("form",this.d),this.form.validate({submitHandler:function(e){t.do_save(e)}}),this.d.on("click","#giveup",function(e){t.giveup(e)}),0==IsBound&&this.getQrCode()},getQrCode:function(){$("#google2faKey").val(""),G.get({url:SESSIONID+"/Member/GetGaQrCode",success:function(e){1===e.Status&&($("#google2fa-qrcode").attr("src",e.Data.QrCodeUrl),$("#google2faKey").val(e.Data.ManualEntryKey))}})},giveup:function(e){var t={btn:["继续绑定","暂不绑订"]};$.confirm("您明白及同意，取消双重身分验证，会使您暴露在账户及密码被盗的危险中",t,function(e){$.close(e)},function(){$.confirm("如需重新设置，请至(个人资讯)页面进行绑定",t,function(e){$.close(e)},function(e){$.close(e),G.post({url:SESSIONID+"/Member/SkipOtp",success:function(e){location.href=SESSIONID+"/Member/GetAgreement"}})})})},do_save:function(e){var t=$.unparam(this.form.serialize());G.post({url:SESSIONID+"/Member/DoGaOtpLogin",data:t,success:function(e){location.href=SESSIONID+"/Member/GetAgreement"}})}},e});define("Member/customAccount",[],function(){function t(t){this.d=$(t)}return t.prototype={init:function(){var e=this;this.form=$("form",this.d),this.form.validate({submitHandler:function(t){e.do_save(t)}})},beforeSend:function(t){var e={},n=$("#custom_account").val(),o=$("#old_password").val(),c=$("#new_pwd").val();return e.Info=callSecret(encodeURIComponent(n)+","+encodeURIComponent(c)+","+encodeURIComponent(o)),e},do_save:function(t){var e=this,t=this.beforeSend(t);G.post({url:"/Member/SetCustomAccount",data:t,success:function(t){1==t.Status&&(e.d.data().mustchange?location.href=SESSIONID+"/App/Index":(e.form[0].reset(),$.alert("自定义帐号成功")))}})}},t});define("Member/login",[],function(){function t(t){this.d=$(t)}return t.prototype={init:function(){var a=this;document.forms[0].account.focus(),$(document.forms[0]).validate({submitHandler:function(t){a.do_save(t)}}),this.d.on("click","#imgCaptcha",function(){a.get_captcha()}),this.checkCaptcha()},beforeSend:function(t){var a={},e=$('input[name="account"]').val(),n=$('input[name="password"]').val(),c=$('input[name="captcha"]').val();return a.Info=callSecret(encodeURIComponent(e)+","+encodeURIComponent(n)),a.Captcha=c,a.Token=G.util.getQueryString("Token"),a},do_save:function(a){var t=this.beforeSend(a);G.get({url:"/Member/DoLogin",data:t,bussiness:function(t){a.password.value="",$.alert(t)},success:function(t){location.href=SESSIONID+"/Member/GetAgreement"}})},get_captcha:function(){$("#captcha").val(""),$("#imgCaptcha").removeClass("hide"),$.ajax({url:SESSIONID+"/Member/GetCaptcha",type:"get",dataType:"json",success:function(t){1===t.Status?$("#imgCaptcha").attr("src","https://f1.safelogin.cc/Captcha/GetCaptcha?AppId=AppSSC&Token="+t.Data):alert(t.Data)}})},checkCaptcha:function(){$(".captchaContent").hasClass("hide")||$("#imgCaptcha").click()}},t});define("Member/password",[],function(){function e(e){this.d=$(e),3==G.util.getQueryString("m")&&$("#btn_extend").removeClass("hide").css("display","inline-block")}return e.prototype={init:function(){var t=this;this.form=$("form",this.d),this.form.validate({submitHandler:function(e){t.do_save(e)}}),this.d.on("click","#btn_extend",function(){$("#btn_extend").prop("disabled",!0),G.get({url:"/Member/ExtendPassword",success:function(e){$("#btn_extend").prop("disabled",!1),1==e.Status?location.href=SESSIONID+"/App/Index":($(":password").val(""),alert(e.Data))},complete:function(){$("#btn_extend").prop("disabled",!1)}})})},beforeSend:function(e){var t={},n=$("#old_password").val(),o=$("#new_pwd").val();return t.Info=callSecret(encodeURIComponent(n)+","+encodeURIComponent(o)),t},do_save:function(e){var t=this,e=this.beforeSend(e);G.post({url:"/Member/ChangePassword",data:e,success:function(e){1==e.Status&&(t.d.data().mustchange?location.href=SESSIONID+"/App/Index":(t.form[0].reset(),$.alert("密码修改成功")))}})}},e});